<?xml version="1.0" encoding="UTF-8"?>
	<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
		    
<mapper namespace="com.seok.home.member.MemberDAO">
	
	<select id="getLogin" parameterType="MemberDTO" resultMap="getLoginResult">
      SELECT M.ID, M.NAME, MR.ROLENUM, R.ROLENAME
      FROM MEMBER M
         INNER JOIN
         MEMBER_ROLE MR
         ON (M.ID=MR.ID)
         INNER JOIN
         ROLE R
         ON (MR.ROLENUM=R.ROLENUM)
      WHERE M.ID=#{id} AND M.PW=#{pw}
      ORDER BY R.ROLENUM ASC
   </select>
   
   <resultMap type="MemberDTO" id="getLoginResult">
      <id column="ID" property="id"></id>
      <result column="NAME" property="name"/>
      <collection property="roleDTOs" javaType="List" ofType="RoleDTO">
         <id column="ROLENUM" property="roleNum"/>
         <result column="ROLENAME" property="roleName"/>
      </collection>
   </resultMap>
	
	<insert id="setJoin" parameterType="MemberDTO">
		INSERT INTO MEMBER(ID, PW, NAME, N_NAME, B_DATE, GENDER, EMAIL, PHONE, POINT)
		VALUES (#{id}, #{pw}, #{name}, #{n_name}, #{b_date}, #{gender}, #{email}, #{phone}, 0)
	</insert>
	
</mapper> 